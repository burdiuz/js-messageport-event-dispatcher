{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///messageport-dispatcher.min.js","webpack:///webpack/bootstrap 345345c575467797f5c4","webpack:///./source/MessagePortDispatcher.js","webpack:///./~/event-dispatcher/source/EventDispatcher.js","webpack:///./~/event-dispatcher/source/index.js","webpack:///./source/index.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","TypeError","create","constructor","writable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","MessagePortDispatcher","MessagePortEvent","undefined","_createClass","defineProperties","target","props","length","descriptor","key","protoProps","staticProps","_eventDispatcher","_eventDispatcher2","obj","default","event","dispatcherId","toJSON","result","parse","isEvent","isObject","_EventDispatcher","customPostMessageHandler","arguments","receiverEventPreprocessor","senderEventPreprocessor","noInit","_this","getPrototypeOf","initiallize","_handlers","sender","receiver","Math","ceil","random","Date","now","targetOrigin","addEventListener","bind","hasEventListener","removeEventListener","removeAllEventListeners","_messageEventListener","eventType","data","transferList","getEvent","eventJson","_postMessageHandler","handler","postMessage","nativeEvent","message","dispatchEvent","JSON","stringify","error","getTarget","dispatcher","parent","top","_typeof","Symbol","iterator","hasOwnProp","Event","type","defaultPrevented","EventListeners","_listeners","priority","parseInt","getPrioritiesByKey","String","handlers","createList","indexOf","push","priorities","list","getOwnPropertyNames","index","handlerIndex","splice","_stopped","_immediatelyStopped","stopPropagation","stopImmediatePropagation","sort","a","b","handlersLength","handlersIndex","EventDispatcher","eventPreprocessor","initialize","_eventPreprocessor","listener","add","has","remove","removeAll","eventObject","eventOrType","optionalData","_EventDispatcher2","_MessagePortDispatcher","_MessagePortDispatcher2"],"mappings":"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","file":"messageport-dispatcher.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MessagePortDispatcher\"] = factory();\n\telse\n\t\troot[\"MessagePortDispatcher\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MessagePortDispatcher\"] = factory();\n\telse\n\t\troot[\"MessagePortDispatcher\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"http://localhost:8081/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MessagePortDispatcher = exports.MessagePortEvent = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Created by Oleg Galaburda on 09.02.16.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * \r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _eventDispatcher = __webpack_require__(2);\n\nvar _eventDispatcher2 = _interopRequireDefault(_eventDispatcher);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MessagePortEvent = exports.MessagePortEvent = function () {\n  function MessagePortEvent(event, dispatcherId) {\n    _classCallCheck(this, MessagePortEvent);\n\n    this.event = event;\n    this.dispatcherId = dispatcherId;\n  }\n\n  _createClass(MessagePortEvent, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      return {\n        /* eslint no-use-before-define:0 */\n        event: MessagePortDispatcher.toJSON(this.event),\n        dispatcherId: this.dispatcherId\n      };\n    }\n  }], [{\n    key: 'parse',\n    value: function parse(object) {\n      /* eslint no-use-before-define:0 */\n      var result = MessagePortDispatcher.parse(object);\n      if (MessagePortEvent.isEvent(result)) {\n        /* eslint no-use-before-define:0 */\n        result.event = MessagePortDispatcher.parse(result.event);\n      } else {\n        result = null;\n      }\n      return result;\n    }\n  }, {\n    key: 'isEvent',\n    value: function isEvent(object) {\n      return _eventDispatcher2.default.isObject(object) && Object.prototype.hasOwnProperty.call(object, 'dispatcherId') && Object.prototype.hasOwnProperty.call(object, 'event');\n    }\n  }]);\n\n  return MessagePortEvent;\n}();\n\nvar MessagePortDispatcher = exports.MessagePortDispatcher = function (_EventDispatcher) {\n  _inherits(MessagePortDispatcher, _EventDispatcher);\n\n  /**\r\n   *\r\n   * @param target {Window|Worker|MessagePort}\r\n   * @param customPostMessageHandler {?Function} Function that receive message object\r\n   *        and pass it to MessagePort.postMessage()\r\n   * @param receiverEventPreprocessor {?Function} Function that pre-process\r\n   *        all events received from MessagePort, before passing to listeners\r\n   * @param senderEventPreprocessor Function that pre-process all events sent\r\n   *        to MessagePort\r\n   * @constructor\r\n   */\n  function MessagePortDispatcher(target) {\n    var customPostMessageHandler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var receiverEventPreprocessor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var senderEventPreprocessor = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var noInit = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n    _classCallCheck(this, MessagePortDispatcher);\n\n    var _this = _possibleConstructorReturn(this, (MessagePortDispatcher.__proto__ || Object.getPrototypeOf(MessagePortDispatcher)).call(this, null, true));\n\n    if (!noInit) {\n      _this.initiallize(target, customPostMessageHandler, receiverEventPreprocessor, senderEventPreprocessor);\n    }\n    return _this;\n  }\n\n  /**\r\n   * @private\r\n   */\n\n\n  _createClass(MessagePortDispatcher, [{\n    key: 'initiallize',\n    value: function initiallize(target, customPostMessageHandler, receiverEventPreprocessor, senderEventPreprocessor) {\n      this.target = target || self;\n      this._handlers = {\n        customPostMessageHandler: customPostMessageHandler,\n        senderEventPreprocessor: senderEventPreprocessor\n      };\n      this.sender = _eventDispatcher2.default.create();\n      this.receiver = _eventDispatcher2.default.create(receiverEventPreprocessor);\n      this.dispatcherId = 'MP/' + Math.ceil(Math.random() * 10000) + '/' + Date.now();\n      this.targetOrigin = '*';\n      this.addEventListener = this.receiver.addEventListener.bind(this.receiver);\n      this.hasEventListener = this.receiver.hasEventListener.bind(this.receiver);\n      this.removeEventListener = this.receiver.removeEventListener.bind(this.receiver);\n      this.removeAllEventListeners = this.receiver.removeAllEventListeners.bind(this.receiver);\n\n      target.addEventListener('message', this._messageEventListener.bind(this));\n    }\n  }, {\n    key: 'dispatchEvent',\n    value: function dispatchEvent(eventType, data, transferList) {\n      var event = _eventDispatcher2.default.getEvent(eventType, data);\n      if (this._handlers.senderEventPreprocessor) {\n        event = this._handlers.senderEventPreprocessor.call(this, event);\n      }\n      var eventJson = MessagePortDispatcher.toJSON(new MessagePortEvent(event, this.dispatcherId));\n      this._postMessageHandler(eventJson, transferList);\n    }\n  }, {\n    key: '_postMessageHandler',\n    value: function _postMessageHandler(data, transferList) {\n      var handler = this._handlers.customPostMessageHandler;\n      if (handler) {\n        handler.call(this, data, this.targetOrigin, transferList);\n      } else {\n        this.target.postMessage(data, this.targetOrigin, transferList);\n      }\n    }\n  }, {\n    key: '_messageEventListener',\n    value: function _messageEventListener(event) {\n      // fixme .nativeEvent react-native thing, need a way to find out keep it or exclude\n      event = event.nativeEvent || event;\n      var message = MessagePortEvent.parse(event.data);\n      if (message) {\n        if (message.dispatcherId === this.dispatcherId) {\n          this.sender.dispatchEvent(message.event);\n        } else {\n          this.receiver.dispatchEvent(message.event);\n        }\n      }\n    }\n\n    /**\r\n     * If toJSON method implemented on object, it will be called instead of converting to JSON string.\r\n     * This was made to utilize structured cloning algorithm for raw objects.\r\n     * https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\r\n     * In this case developer is responsible for converting linked objects.\r\n     * @param object\r\n     * @returns {Object|String}\r\n     */\n\n  }], [{\n    key: 'toJSON',\n    value: function toJSON(object) {\n      var objectJson = void 0;\n      if (typeof object.toJSON === 'function') {\n        objectJson = object.toJSON();\n      } else {\n        objectJson = JSON.stringify(object);\n      }\n      return objectJson;\n    }\n\n    /**\r\n     *\r\n     * @param data {Object|String}\r\n     * @returns {Object}\r\n     */\n\n  }, {\n    key: 'parse',\n    value: function parse(data) {\n      var object = void 0; // keep it undefined in case of error\n      if (_eventDispatcher2.default.isObject(data)) {\n        object = data;\n      } else {\n        try {\n          object = JSON.parse(data);\n        } catch (error) {\n          // this isn't an event we are waiting for.\n        }\n      }\n      return object;\n    }\n  }, {\n    key: 'create',\n    value: function create(target, customPostMessageHandler, receiverEventPreprocessor, senderEventPreprocessor) {\n      return new MessagePortDispatcher(target, customPostMessageHandler, receiverEventPreprocessor, senderEventPreprocessor);\n    }\n  }]);\n\n  return MessagePortDispatcher;\n}(_eventDispatcher2.default);\n\nvar factory = function factory(getTarget) {\n  var dispatcher = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  return function () {\n    if (!dispatcher) {\n      dispatcher = MessagePortDispatcher.create(getTarget());\n    }\n    return dispatcher;\n  };\n};\n\nMessagePortDispatcher.self = factory(function () {\n  return self;\n});\nMessagePortDispatcher.parent = factory(function () {\n  return parent;\n});\nMessagePortDispatcher.top = factory(function () {\n  return top;\n});\nMessagePortDispatcher.MessagePortEvent = MessagePortEvent;\n\nexports.default = MessagePortDispatcher;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar hasOwnProp = function hasOwnProp(target, name) {\n  return Object.prototype.hasOwnProperty.call(target, name);\n}; /**\r\n    * Created by Oleg Galaburda on 09.02.16.\r\n    * \r\n    */\n\nvar Event = exports.Event = function () {\n  function Event(type, data) {\n    _classCallCheck(this, Event);\n\n    this.type = type;\n    this.data = data || null;\n    this.defaultPrevented = false;\n  }\n\n  _createClass(Event, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      return { type: this.type, data: this.data };\n    }\n  }, {\n    key: 'isDefaultPrevented',\n    value: function isDefaultPrevented() {\n      return this.defaultPrevented;\n    }\n  }, {\n    key: 'preventDefault',\n    value: function preventDefault() {\n      this.defaultPrevented = true;\n    }\n  }]);\n\n  return Event;\n}();\n\nvar EventListeners = function () {\n  function EventListeners() {\n    _classCallCheck(this, EventListeners);\n\n    /**\r\n     * key - event Type\r\n     * value - hash of priorities\r\n     *    key - priority\r\n     *    value - list of handlers\r\n     * @type {Object<string, Object.<string, Array<number, Function>>>}\r\n     * @private\r\n     */\n    this._listeners = {};\n  }\n\n  _createClass(EventListeners, [{\n    key: 'createList',\n    value: function createList(eventType, priority) {\n      priority = parseInt(priority, 10);\n      var target = this.getPrioritiesByKey(eventType);\n      var key = String(priority);\n      var value = void 0;\n      if (hasOwnProp(target, key)) {\n        value = target[key];\n      } else {\n        value = [];\n        target[key] = value;\n      }\n      return value;\n    }\n  }, {\n    key: 'getPrioritiesByKey',\n    value: function getPrioritiesByKey(key) {\n      var value = void 0;\n      if (hasOwnProp(this._listeners, key)) {\n        value = this._listeners[key];\n      } else {\n        value = {};\n        this._listeners[key] = value;\n      }\n      return value;\n    }\n  }, {\n    key: 'add',\n    value: function add(eventType, handler, priority) {\n      var handlers = this.createList(eventType, priority);\n      if (handlers.indexOf(handler) < 0) {\n        handlers.push(handler);\n      }\n    }\n  }, {\n    key: 'has',\n    value: function has(eventType) {\n      var priority = void 0;\n      var result = false;\n      var priorities = this.getPrioritiesByKey(eventType);\n      if (priorities) {\n        for (priority in priorities) {\n          if (hasOwnProp(priorities, priority)) {\n            result = true;\n            break;\n          }\n        }\n      }\n      return result;\n    }\n  }, {\n    key: 'remove',\n    value: function remove(eventType, handler) {\n      var priorities = this.getPrioritiesByKey(eventType);\n      if (priorities) {\n        var list = Object.getOwnPropertyNames(priorities);\n        var length = list.length;\n        for (var index = 0; index < length; index++) {\n          var _priority = list[index];\n          var handlers = priorities[_priority];\n          var handlerIndex = handlers.indexOf(handler);\n          if (handlerIndex >= 0) {\n            handlers.splice(handlerIndex, 1);\n            if (!handlers.length) {\n              delete priorities[_priority];\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: 'removeAll',\n    value: function removeAll(eventType) {\n      delete this._listeners[eventType];\n    }\n  }, {\n    key: 'call',\n    value: function call(event, target) {\n      var handler = void 0;\n      var _stopped = false;\n      var _immediatelyStopped = false;\n      var stopPropagation = function stopPropagation() {\n        _stopped = true;\n      };\n      var stopImmediatePropagation = function stopImmediatePropagation() {\n        _immediatelyStopped = true;\n      };\n      event.stopPropagation = stopPropagation;\n      event.stopImmediatePropagation = stopImmediatePropagation;\n      var priorities = this.getPrioritiesByKey(event.type, this._listeners);\n      if (priorities) {\n        // getOwnPropertyNames() or keys()?\n        var list = Object.getOwnPropertyNames(priorities).sort(function (a, b) {\n          return a - b;\n        });\n        var length = list.length;\n        for (var index = 0; index < length; index++) {\n          if (_stopped) break;\n          var handlers = priorities[list[index]];\n          var handlersLength = handlers.length;\n          for (var handlersIndex = 0; handlersIndex < handlersLength; handlersIndex++) {\n            if (_immediatelyStopped) break;\n            handler = handlers[handlersIndex];\n            handler.call(target, event);\n          }\n        }\n      }\n      delete event.stopPropagation;\n      delete event.stopImmediatePropagation;\n    }\n  }]);\n\n  return EventListeners;\n}();\n\nvar EventDispatcher = function () {\n  function EventDispatcher(eventPreprocessor) {\n    var noInit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    _classCallCheck(this, EventDispatcher);\n\n    if (!noInit) {\n      this.initialize(eventPreprocessor);\n    }\n  }\n\n  /**\r\n   * @private\r\n   */\n\n\n  _createClass(EventDispatcher, [{\n    key: 'initialize',\n    value: function initialize(eventPreprocessor) {\n      this._eventPreprocessor = eventPreprocessor;\n      this._listeners = new EventListeners();\n    }\n  }, {\n    key: 'addEventListener',\n    value: function addEventListener(eventType, listener) {\n      var priority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      this._listeners.add(eventType, listener, -priority || 0);\n    }\n  }, {\n    key: 'hasEventListener',\n    value: function hasEventListener(eventType) {\n      return this._listeners.has(eventType);\n    }\n  }, {\n    key: 'removeEventListener',\n    value: function removeEventListener(eventType, listener) {\n      this._listeners.remove(eventType, listener);\n    }\n  }, {\n    key: 'removeAllEventListeners',\n    value: function removeAllEventListeners(eventType) {\n      this._listeners.removeAll(eventType);\n    }\n  }, {\n    key: 'dispatchEvent',\n    value: function dispatchEvent(event, data) {\n      var eventObject = EventDispatcher.getEvent(event, data);\n      if (this._eventPreprocessor) {\n        eventObject = this._eventPreprocessor.call(this, eventObject);\n      }\n      this._listeners.call(eventObject);\n    }\n  }], [{\n    key: 'isObject',\n    value: function isObject(value) {\n      return (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value !== null;\n    }\n  }, {\n    key: 'getEvent',\n    value: function getEvent(eventOrType, optionalData) {\n      var event = eventOrType;\n      if (!EventDispatcher.isObject(eventOrType)) {\n        event = new EventDispatcher.Event(String(eventOrType), optionalData);\n      }\n      return event;\n    }\n  }, {\n    key: 'create',\n    value: function create(eventPreprocessor) {\n      return new EventDispatcher(eventPreprocessor);\n    }\n\n    /* eslint no-undef: \"off\" */\n\n  }]);\n\n  return EventDispatcher;\n}();\n\nEventDispatcher.Event = Event;\n\nexports.default = EventDispatcher;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Event = undefined;\n\nvar _EventDispatcher = __webpack_require__(1);\n\nvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _EventDispatcher2.default;\nexports.Event = _EventDispatcher.Event;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MessagePortEvent = undefined;\n\nvar _MessagePortDispatcher = __webpack_require__(0);\n\nvar _MessagePortDispatcher2 = _interopRequireDefault(_MessagePortDispatcher);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _MessagePortDispatcher2.default;\nexports.MessagePortEvent = _MessagePortDispatcher.MessagePortEvent;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// messageport-dispatcher.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"http://localhost:8081/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 345345c575467797f5c4","/**\r\n * Created by Oleg Galaburda on 09.02.16.\r\n * @flow\r\n */\r\n\r\nimport EventDispatcher from 'event-dispatcher';\r\n\r\nimport type {\r\n  EventObject,\r\n  EventListener,\r\n  EventProcessor,\r\n  PostMessage,\r\n  IMessagePortEvent,\r\n  MessagePortTarget,\r\n} from './TypeDefinition';\r\n\r\nexport class MessagePortEvent implements IMessagePortEvent {\r\n  constructor(event: EventObject, dispatcherId: string) {\r\n    this.event = event;\r\n    this.dispatcherId = dispatcherId;\r\n  }\r\n\r\n  toJSON(): IMessagePortEvent {\r\n    return {\r\n      /* eslint no-use-before-define:0 */\r\n      event: MessagePortDispatcher.toJSON(this.event),\r\n      dispatcherId: this.dispatcherId,\r\n    };\r\n  }\r\n\r\n  static parse(object: mixed): string {\r\n    /* eslint no-use-before-define:0 */\r\n    let result = MessagePortDispatcher.parse(object);\r\n    if (MessagePortEvent.isEvent(result)) {\r\n      /* eslint no-use-before-define:0 */\r\n      result.event = MessagePortDispatcher.parse(result.event);\r\n    } else {\r\n      result = null;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  static isEvent(object) {\r\n    return EventDispatcher.isObject(object) &&\r\n      Object.prototype.hasOwnProperty.call(object, 'dispatcherId') &&\r\n      Object.prototype.hasOwnProperty.call(object, 'event');\r\n  }\r\n}\r\n\r\ntype StaticGlobalDispatcher = ()=> MessagePortDispatcher;\r\ntype MPDispatcherInternals = {\r\n  customPostMessageHandler?: PostMessage,\r\n  senderEventPreprocessor?: EventProcessor\r\n};\r\n\r\nexport class MessagePortDispatcher extends EventDispatcher {\r\n  _handlers: MPDispatcherInternals;\r\n  sender: EventDispatcher;\r\n  receiver: EventDispatcher;\r\n  dispatcherId: string;\r\n  targetOrigin: string;\r\n  addEventListener: (type: string, handler: EventListener) => void;\r\n  hasEventListener: (eventType: string) => boolean;\r\n  removeEventListener: (eventType: string) => void;\r\n  removeAllEventListeners: (eventType: string) => void;\r\n\r\n  /**\r\n   *\r\n   * @param target {Window|Worker|MessagePort}\r\n   * @param customPostMessageHandler {?Function} Function that receive message object\r\n   *        and pass it to MessagePort.postMessage()\r\n   * @param receiverEventPreprocessor {?Function} Function that pre-process\r\n   *        all events received from MessagePort, before passing to listeners\r\n   * @param senderEventPreprocessor Function that pre-process all events sent\r\n   *        to MessagePort\r\n   * @constructor\r\n   */\r\n  constructor(\r\n    target: MessagePortTarget,\r\n    customPostMessageHandler?: PostMessage = null,\r\n    receiverEventPreprocessor?: EventProcessor = null,\r\n    senderEventPreprocessor: EventProcessor = null,\r\n    noInit = false,\r\n  ) {\r\n    super(null, true);\r\n    if (!noInit) {\r\n      this.initiallize(\r\n        target,\r\n        customPostMessageHandler,\r\n        receiverEventPreprocessor,\r\n        senderEventPreprocessor,\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  initiallize(\r\n    target,\r\n    customPostMessageHandler,\r\n    receiverEventPreprocessor,\r\n    senderEventPreprocessor,\r\n  ) {\r\n    this.target = target || self;\r\n    this._handlers = {\r\n      customPostMessageHandler,\r\n      senderEventPreprocessor,\r\n    };\r\n    this.sender = EventDispatcher.create();\r\n    this.receiver = EventDispatcher.create(receiverEventPreprocessor);\r\n    this.dispatcherId = `MP/${Math.ceil(Math.random() * 10000)}/${Date.now()}`;\r\n    this.targetOrigin = '*';\r\n    this.addEventListener = this.receiver.addEventListener.bind(this.receiver);\r\n    this.hasEventListener = this.receiver.hasEventListener.bind(this.receiver);\r\n    this.removeEventListener = this.receiver.removeEventListener.bind(this.receiver);\r\n    this.removeAllEventListeners = this.receiver.removeAllEventListeners.bind(this.receiver);\r\n\r\n    target.addEventListener('message', this._messageEventListener.bind(this));\r\n  }\r\n\r\n  dispatchEvent(eventType, data, transferList) {\r\n    let event = EventDispatcher.getEvent(eventType, data);\r\n    if (this._handlers.senderEventPreprocessor) {\r\n      event = this._handlers.senderEventPreprocessor.call(this, event);\r\n    }\r\n    const eventJson = MessagePortDispatcher.toJSON(\r\n      new MessagePortEvent(event, this.dispatcherId),\r\n    );\r\n    this._postMessageHandler(eventJson, transferList);\r\n  }\r\n\r\n  _postMessageHandler(data, transferList) {\r\n    const handler = this._handlers.customPostMessageHandler;\r\n    if (handler) {\r\n      handler.call(this, data, this.targetOrigin, transferList);\r\n    } else {\r\n      this.target.postMessage(data, this.targetOrigin, transferList);\r\n    }\r\n  }\r\n\r\n  _messageEventListener(event) {\r\n    // fixme .nativeEvent react-native thing, need a way to find out keep it or exclude\r\n    event = event.nativeEvent || event;\r\n    const message = MessagePortEvent.parse(event.data);\r\n    if (message) {\r\n      if (message.dispatcherId === this.dispatcherId) {\r\n        this.sender.dispatchEvent(message.event);\r\n      } else {\r\n        this.receiver.dispatchEvent(message.event);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * If toJSON method implemented on object, it will be called instead of converting to JSON string.\r\n   * This was made to utilize structured cloning algorithm for raw objects.\r\n   * https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\r\n   * In this case developer is responsible for converting linked objects.\r\n   * @param object\r\n   * @returns {Object|String}\r\n   */\r\n  static toJSON(object) {\r\n    let objectJson;\r\n    if (typeof (object.toJSON) === 'function') {\r\n      objectJson = object.toJSON();\r\n    } else {\r\n      objectJson = JSON.stringify(object);\r\n    }\r\n    return objectJson;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param data {Object|String}\r\n   * @returns {Object}\r\n   */\r\n  static parse(data) {\r\n    let object; // keep it undefined in case of error\r\n    if (EventDispatcher.isObject(data)) {\r\n      object = data;\r\n    } else {\r\n      try {\r\n        object = JSON.parse(data);\r\n      } catch (error) {\r\n        // this isn't an event we are waiting for.\r\n      }\r\n    }\r\n    return object;\r\n  }\r\n\r\n  static create(\r\n    target,\r\n    customPostMessageHandler,\r\n    receiverEventPreprocessor,\r\n    senderEventPreprocessor,\r\n  ) {\r\n    return new MessagePortDispatcher(\r\n      target,\r\n      customPostMessageHandler,\r\n      receiverEventPreprocessor,\r\n      senderEventPreprocessor,\r\n    );\r\n  }\r\n\r\n  static self: StaticGlobalDispatcher;\r\n  static parent: StaticGlobalDispatcher;\r\n  static top: StaticGlobalDispatcher;\r\n}\r\n\r\nconst factory = (\r\n  getTarget: () => MessagePortTarget,\r\n  dispatcher: MessagePortDispatcher = null,\r\n): StaticGlobalDispatcher => (): MessagePortDispatcher => {\r\n  if (!dispatcher) {\r\n    dispatcher = MessagePortDispatcher.create(getTarget());\r\n  }\r\n  return dispatcher;\r\n};\r\n\r\nMessagePortDispatcher.self = factory(() => self);\r\nMessagePortDispatcher.parent = factory(() => parent);\r\nMessagePortDispatcher.top = factory(() => top);\r\nMessagePortDispatcher.MessagePortEvent = MessagePortEvent;\r\n\r\nexport default MessagePortDispatcher;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/MessagePortDispatcher.js","/**\r\n * Created by Oleg Galaburda on 09.02.16.\r\n * @flow\r\n */\r\n\r\nimport type {\r\n  EventObject,\r\n  EventType,\r\n  EventListener,\r\n  EventProcessor,\r\n  IEvent,\r\n  IEventDispatcher,\r\n} from './TypeDefinition';\r\n\r\nconst hasOwnProp = (target: any, name: string): boolean => (\r\n  Object.prototype.hasOwnProperty.call(target, name)\r\n);\r\n\r\nexport class Event implements IEvent {\r\n\r\n  type: string;\r\n  data: mixed;\r\n  defaultPrevented: boolean;\r\n  stopPropagation: ?() => void;\r\n  stopImmediatePropagation: ?() => void;\r\n\r\n  constructor(type: string, data: mixed) {\r\n    this.type = type;\r\n    this.data = data || null;\r\n    this.defaultPrevented = false;\r\n  }\r\n\r\n  toJSON(): EventObject {\r\n    return { type: this.type, data: this.data };\r\n  }\r\n\r\n  isDefaultPrevented(): boolean {\r\n    return this.defaultPrevented;\r\n  }\r\n\r\n  preventDefault() {\r\n    this.defaultPrevented = true;\r\n  }\r\n}\r\n\r\ntype EventPrioritiesCollection = {\r\n  [priority:string]: Array<EventListener>;\r\n}\r\n\r\ntype EventTypesCollection = {\r\n  [eventType:string]: EventPrioritiesCollection;\r\n}\r\n\r\nclass EventListeners {\r\n\r\n  _listeners: EventTypesCollection;\r\n\r\n  constructor() {\r\n    /**\r\n     * key - event Type\r\n     * value - hash of priorities\r\n     *    key - priority\r\n     *    value - list of handlers\r\n     * @type {Object<string, Object.<string, Array<number, Function>>>}\r\n     * @private\r\n     */\r\n    this._listeners = {};\r\n  }\r\n\r\n  createList(eventType: string, priority: number): Array<EventListener> {\r\n    priority = parseInt(priority, 10);\r\n    const target: EventPrioritiesCollection = this.getPrioritiesByKey(eventType);\r\n    const key: string = String(priority);\r\n    let value: Array<EventListener>;\r\n    if (hasOwnProp(target, key)) {\r\n      value = target[key];\r\n    } else {\r\n      value = [];\r\n      target[key] = value;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  getPrioritiesByKey(key: string): EventPrioritiesCollection {\r\n    let value: EventPrioritiesCollection;\r\n    if (hasOwnProp(this._listeners, key)) {\r\n      value = this._listeners[key];\r\n    } else {\r\n      value = {};\r\n      this._listeners[key] = value;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  add(eventType: string, handler: EventListener, priority: number) {\r\n    const handlers = this.createList(eventType, priority);\r\n    if (handlers.indexOf(handler) < 0) {\r\n      handlers.push(handler);\r\n    }\r\n  }\r\n\r\n  has(eventType: string): boolean {\r\n    let priority: string;\r\n    let result = false;\r\n    const priorities = this.getPrioritiesByKey(eventType);\r\n    if (priorities) {\r\n      for (priority in priorities) {\r\n        if (hasOwnProp(priorities, priority)) {\r\n          result = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  remove(eventType: string, handler) {\r\n    const priorities = this.getPrioritiesByKey(eventType);\r\n    if (priorities) {\r\n      const list = Object.getOwnPropertyNames(priorities);\r\n      const length = list.length;\r\n      for (let index = 0; index < length; index++) {\r\n        const priority = list[index];\r\n        const handlers = priorities[priority];\r\n        const handlerIndex = handlers.indexOf(handler);\r\n        if (handlerIndex >= 0) {\r\n          handlers.splice(handlerIndex, 1);\r\n          if (!handlers.length) {\r\n            delete priorities[priority];\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  removeAll(eventType: string) {\r\n    delete this._listeners[eventType];\r\n  }\r\n\r\n  call(event: EventObject, target: any) {\r\n    let handler: EventListener;\r\n    let _stopped = false;\r\n    let _immediatelyStopped = false;\r\n    const stopPropagation = () => {\r\n      _stopped = true;\r\n    };\r\n    const stopImmediatePropagation = () => {\r\n      _immediatelyStopped = true;\r\n    };\r\n    event.stopPropagation = stopPropagation;\r\n    event.stopImmediatePropagation = stopImmediatePropagation;\r\n    const priorities = this.getPrioritiesByKey(event.type, this._listeners);\r\n    if (priorities) {\r\n      // getOwnPropertyNames() or keys()?\r\n      const list: string[] = Object.getOwnPropertyNames(priorities).sort(\r\n        (a: any, b: any) => (a - b),\r\n      );\r\n      const length = list.length;\r\n      for (let index = 0; index < length; index++) {\r\n        if (_stopped) break;\r\n        const handlers: Array<EventListener> = priorities[list[index]];\r\n        const handlersLength = handlers.length;\r\n        for (let handlersIndex = 0; handlersIndex < handlersLength; handlersIndex++) {\r\n          if (_immediatelyStopped) break;\r\n          handler = handlers[handlersIndex];\r\n          handler.call(target, event);\r\n        }\r\n      }\r\n    }\r\n    delete event.stopPropagation;\r\n    delete event.stopImmediatePropagation;\r\n  }\r\n}\r\n\r\nclass EventDispatcher implements IEventDispatcher {\r\n\r\n  _listeners: EventListeners;\r\n  _eventPreprocessor: EventProcessor;\r\n\r\n  constructor(eventPreprocessor: EventProcessor, noInit: boolean = false) {\r\n    if (!noInit) {\r\n      this.initialize(eventPreprocessor);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  initialize(eventPreprocessor: EventProcessor) {\r\n    this._eventPreprocessor = eventPreprocessor;\r\n    this._listeners = new EventListeners();\r\n  }\r\n\r\n  addEventListener(eventType: string, listener: EventListener, priority: number = 0) {\r\n    this._listeners.add(eventType, listener, -priority || 0);\r\n  }\r\n\r\n  hasEventListener(eventType: string) {\r\n    return this._listeners.has(eventType);\r\n  }\r\n\r\n  removeEventListener(eventType: string, listener: EventListener) {\r\n    this._listeners.remove(eventType, listener);\r\n  }\r\n\r\n  removeAllEventListeners(eventType: string) {\r\n    this._listeners.removeAll(eventType);\r\n  }\r\n\r\n  dispatchEvent(event: EventType, data: mixed) {\r\n    let eventObject = EventDispatcher.getEvent(event, data);\r\n    if (this._eventPreprocessor) {\r\n      eventObject = this._eventPreprocessor.call(this, eventObject);\r\n    }\r\n    this._listeners.call(eventObject);\r\n  }\r\n\r\n  static isObject(value: mixed) {\r\n    return (typeof value === 'object') && (value !== null);\r\n  }\r\n\r\n  static getEvent(eventOrType: EventType, optionalData: mixed): EventObject {\r\n    let event = eventOrType;\r\n    if (!EventDispatcher.isObject(eventOrType)) {\r\n      event = new EventDispatcher.Event(String(eventOrType), optionalData);\r\n    }\r\n    return (event:any);\r\n  }\r\n\r\n  static create(eventPreprocessor: EventProcessor) {\r\n    return new EventDispatcher(eventPreprocessor);\r\n  }\r\n\r\n  /* eslint no-undef: \"off\" */\r\n  static Event: Class<Event>;\r\n}\r\n\r\nEventDispatcher.Event = Event;\r\n\r\nexport default EventDispatcher;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/event-dispatcher/source/EventDispatcher.js","import EventDispatcher, { Event } from './EventDispatcher';\r\n\r\nexport default EventDispatcher;\r\nexport { Event };\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/event-dispatcher/source/index.js","import MessagePortDispatcher, { MessagePortEvent } from './MessagePortDispatcher';\r\n\r\nexport default MessagePortDispatcher;\r\nexport { MessagePortEvent };\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/index.js"],"sourceRoot":""}